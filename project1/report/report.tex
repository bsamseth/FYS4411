\documentclass[twocolumn]{article}
\usepackage{preamble}
% \usepackage{fullpage}
\usepackage{dsfont}


\title{ \small
University of Oslo\\
FYS4411\\
Computational physics II: Quantum mechanical systems\\
\huge Project 1 }
\author{\textsc{Bendik Samseth}}
\date{\today}
\begin{document}
\maketitle


\section{Introduction}
The aim of this project is to use the Variational Monte Carlo
(VMC) method and evaluate the ground state energy of a trapped, hard
sphere Bose gas for different numbers of particles with a specific
trial wave function. This trial wave function is used to study the sensitivity of
condensate and non-condensate properties to the hard sphere radius
and the number of particles.  

\section{Theory}
The trap we will use is a spherical (S)
or an elliptical (E) harmonic trap in one, two and finally three
dimensions, with the latter given by

\begin{equation}
    V_{ext}(\mathbf{r}) = 
    \Bigg\{
        \begin{array}{ll}
            \frac{1}{2}m\omega_{ho}^2r^2 & (S)\\
            \strut
            \frac{1}{2}m[\omega_{ho}^2(x^2+y^2) + \omega_z^2z^2] & (E)
            \label{trap_eqn}
        \end{array}
\end{equation}
The Hamiltonian of the system will be
\begin{equation}
    H = \sum_i^N \left(\frac{-\hbar^2}{2m}{\bigtriangledown }_{i}^2 +V_{ext}({\mathbf{r}}_i)\right)  +
     \sum_{i<j}^{N} V_{int}({\mathbf{r}}_i,{\mathbf{r}}_j),
\end{equation}
Here $\omega_{ho}^2$ defines the trap potential strength.  In the case of the
elliptical trap, $V_{ext}(x,y,z)$, $\omega_{ho}=\omega_{\perp}$ is the trap
frequency in the perpendicular or $xy$ plane and $\omega_z$ the frequency in
the $z$ direction.  The mean square vibrational amplitude of a single boson at
$T=0K$ in the trap (\ref{trap_eqn}) is $\langle
x^2\rangle=(\hbar/2m\omega_{ho})$ so that $a_{ho} \equiv
(\hbar/m\omega_{ho})^{\frac{1}{2}}$ defines the characteristic length of the
trap.  The ratio of the frequencies is denoted
$\lambda=\omega_z/\omega_{\perp}$ leading to a ratio of the trap lengths
$(a_{\perp}/a_z)=(\omega_z/\omega_{\perp})^{\frac{1}{2}} = \sqrt{\lambda}$.

\vspace{0.3cm}\hrule\vspace{0.2cm}
Note: In the rest of this report, as well as in accompanying source code, we
will use natural units with $\hbar = m = 1$.
\vspace{0.2cm}\hrule\vspace{0.3cm}

We will represent the inter-boson interaction by a pairwise,
repulsive potential:
\begin{equation}
    V_{int}(|\mathbf{r}_i-\mathbf{r}_j|) =  \Bigg\{
        \begin{array}{ll}
            \infty & {|\mathbf{r}_i-\mathbf{r}_j|} \leq {a}\\
            0 & {|\mathbf{r}_i-_r\mathbf{r}_j|} > {a}
        \end{array}
\end{equation}
where $a$ is the so-called hard-core diameter of the bosons.
Clearly, $V_{int}(|\mathbf{r}_i-\mathbf{r}_j|)$ is zero if the bosons are
separated by a distance $|\mathbf{r}_i-\mathbf{r}_j|$ greater than $a$ but
infinite if they attempt to come within a distance $|\mathbf{r}_i-\mathbf{r}_j| \leq a$.

Our trial wave function for the ground state with $N$ atoms will be given by
\begin{align}
    \begin{split}
    \Psi_T(\mathbf{r})&=\Psi_T(\mathbf{r}_1, \mathbf{r}_2, \dots
    \mathbf{r}_N,\alpha,\beta)\\
    &=\prod_i g(\alpha,\beta,\mathbf{r}_i)\prod_{i<j}f(a,|\mathbf{r}_i-\mathbf{r}_j|),
    \end{split}
    \label{eq:trialwf}
\end{align}
where $\alpha$ and $\beta$ are variational parameters. We choose the
single-particle wave function to be proportional to the harmonic
oscillator function for the ground state, i.e., we define $g(\alpha,\beta,\mathbf{r}_i)$ as:
\begin{equation}
    g(\alpha,\beta,\mathbf{r}_i)= \exp[-\alpha(x_i^2+y_i^2+\beta z_i^2)].
\end{equation}
For spherical traps we have $\beta = 1$ and for non-interacting
bosons ($a=0$) we have $\alpha = 1/2a_{ho}^2$ resulting in the exact wavefuntion.  The correlation wave
function is

\begin{equation}
    f(a,|\mathbf{r}_i-\mathbf{r}_j|)=\Bigg\{
        \begin{array}{ll}
            0 & {|\mathbf{r}_i-\mathbf{r}_j|} \leq {a}\\
            (1-\frac{a}{|\mathbf{r}_i-\mathbf{r}_j|}) & {|\mathbf{r}_i-\mathbf{r}_j|} > {a}.
        \end{array}
\end{equation}


\subsection{Defining the Objective}
We wish to evaluate the expectation value of the Hamiltonian. We cannot do this
without the true wavefunction of the system, something we do not possess.
We can, however, approximate the energy with the trial wavefunction.
\begin{align}
    E[H] = \expval{H} = \frac{\int \dd{\vec R} \Psi^*_T H \Psi_T}{\int
    \Psi_T^*\Psi_T}.
\end{align}
where $\vec R$ is the matrix containing all the positions of the particles in
the system, $\vec R = [\vec r_1, \vec r_2, \dots, \vec r_N]$.
In order to numerically evaluate this integral we first manipulate it a bit.
The probability density at position $\vec R$, under the trial wavefunction, is
\begin{align}
    P(\vec R, \vec \alpha) &= \frac{\abs{\Psi_T}^2}{\int \dd{\vec R}\abs{\Psi_T}^2}.
\end{align}
where $\vec \alpha$ is used for shorthand and represents the vector of all the variational parameters.
We finally define a new quantity, called the local energy:
\begin{align}
    E_L(\vec R, \vec \alpha) &= \frac{1}{\Psi_T}H\Psi_T\label{eq:E_L}
\end{align}
Combining these two definitions we can now rewrite $\expval{H}$ as follows:
\begin{align}
    \begin{split}
        \expval{H} &= \int \dd{\vec R} P(\vec R,\vec\alpha) E_L(\vec R,\vec\alpha)\\
        &\approx
        \frac{1}{N}\sum_{i=1}^N E_L(\vec R_i,\vec\alpha),
    \end{split}
\end{align}
where $R_i$ are randomly drawn positions from the PDF $P(\vec R, \vec\alpha)$.
We have therefore that estimating the average value of $E_L$ yields an
approximated value for $\expval{H}$. This value is in turn be an upper bound on the
ground state energy, $E_0$. By the variational principle, if we minimize
$\expval{H}$ under the variational parameters, we find an estimate for the true
ground state energy of the system.


\subsection{Finding an Analytical Expression for $E_L$}
As the local energy will is the quantity we are interested in computing for a
large set of positions we would do well to consider how best to evaluate this
expression effectively. Straight forward numerical derivation is of course an
option, but this is likely to be quite time-expensive to do.

The hard part of the expression for $E_L$ is
\begin{align}
    \frac{1}{\Psi_L}\sum_{k}^N\laplacian_k{\Psi_L}.
\end{align}
To get going, we rewrite the wavefunction as
\begin{align}
    \Psi_L(\vec R) &= \prod_i \phi(\vec r_i)\exp(\sum_{i<j}u(r_{ij})),
\end{align}
where $r_{ij} = \norm{\vec r_{ij}} = \norm{\vec r_i - \vec r_j}$, $u(r_{ij}) =
\ln f(r_{ij})$, and $\phi(\vec r_i)=g(\alpha,\beta,\vec r_i)$.

Lets first evaluate the gradient with respect to particle $k$
\begin{align}
    \begin{split}
    \grad_k{\Psi_T(\vec r)}  
    &= \grad_k{\prod_i \phi(\vec r_i)\exp(\sum_{i<j}u(r_{ij}))}\\
    &= \prod_{i\neq k} \phi(\vec r_i)\exp(\sum_{i<j}u(r_{ij}))\grad_k{\phi(\vec
    r_k)}\\
    &+ \prod_{i} \phi(\vec r_i)\grad_k{\exp(\sum_{i<j}u(r_{ij}))}\\
    &= \Psi_T\qty[\frac{\grad_k \phi(\vec r_k)}{\phi(\vec r_k)} + \sum_{j\neq k}
    \grad_k u(r_{kj})].
    \end{split}\label{eq:grad-trail-wf}
\end{align}
The first term is evaluated quite simply:
\begin{align}
    \begin{split}
    \frac{\grad_k\phi(\vec r_k)}{\phi(\vec r_k)} &= \frac{\grad_k}{\phi(\vec r)}
    \exp[-\alpha\qty(x_k^2 + y_k^2 + \beta z_k^2)]\\
    &= \frac{\grad_k}{\phi(\vec r)}\exp[-\alpha\hat{\vec r}_k^2]\\
    &= -2\alpha \hat{\vec r}_k,
    \end{split}\label{eq:grad-phi_k-over-phi_k}
\end{align}
where the notation $\hat{\vec r}_k = (x, y, \beta z)$ is introduced for brevity.
Note that in the 1D and 2D case we simply have $\hat{\vec r}_k = \vec r_k$.


The second term may be evaluated as follows:
\begin{align}
    \begin{split}
    \grad_k u(r_{kj}) &= u'(r_{kj})\grad_k \sqrt{\norm{\vec r_k - \vec r_j}^2} \\
    &= \frac{u'(r_{kj})}{2r_{kj}}\grad_k\qty(\norm{\vec r_k}^2-2\vec r_k\vdot\vec
    r_j+\norm{r_j}^2)\\
    &= u'(r_{kj})\frac{\vec r_{kj}}{r_{kj}}\\
    &= \pdv{}{r_{kj}}\qty[ \ln(1 - \frac{a}{r_{kj}})] \frac{\vec
    r_{kj}}{r_{kj}}\\
    &= \frac{\vec r_{kj}}{r_{kj}}\frac{a}{r_{kj}(r_{kj}-a)}.
    \end{split}\label{eq:grad-u}
\end{align}

Now we can find the Laplacian by taking the divergence of
\eqref{eq:grad-trail-wf}
\begin{align*}
\frac{1}{\Psi_L}\laplacian_k{\Psi_L} &= \frac{1}{\Psi_L}\grad_k\vdot
    \Psi_T\qty[\frac{\grad_k \phi(\vec r_k)}{\phi(\vec r_k)} + \sum_{j\neq k}
    \grad u(r_{kj})] \\
    &= \frac{\laplacian_k \phi(\vec r_k)}{\phi(\vec r_{k})}+\sum_{j\neq
    k}\laplacian_k u(r_{kj})\\
    &+ \frac{\grad_k\qty(\phi(\vec r_k)) \vdot \qty(\sum_{j\neq k} \grad_k
    u(r_{kj}))}{\phi(\vec r_k)}\\
    &+ \left[
        \qty(\frac{\grad_k \phi(\vec r_{k})}{\phi(\vec r_k)} 
        + \sum_{j\neq k}\grad_k u(r_{kj})    )\\
        &\left.\vdot
        \qty(\sum_{j\neq k} \grad_k u(r_{kj})   )\right] \\
    &= \frac{\laplacian_k \phi(\vec r_k)}{\phi(\vec r_k)}
    + 2 \frac{\grad_k \phi(\vec r_k)}{\phi(\vec r_k)}\vdot
    \sum_{j\neq k}\qty( \frac{\vec r_{kj}}{r_{kj}}u'(r_{kj}))\\
    &+ \sum_{i,j \neq k} \frac{\vec r_{ki}\vdot\vec r_{kj}}{r_{ki}r_{kj}}
    u'(r_{ki})u'(r_{kj})
    + \sum_{j\neq k}\laplacian_k u(r_{kj}).\numberthis\label{eq:almost-done-EL}
\end{align*}
There are two new quantities here which need to be evaluated before we are done:
\begin{align}
    \begin{split}
    \frac{\laplacian_k \phi(\vec r_k)}{\phi(\vec r_k)} &=
    2\alpha\qty[2\alpha \norm{\hat{\vec r}_k}^2 - d(\beta)],\\
    &\text{with } d(\beta) = \begin{cases}
        1 &\qfor \text{1D}\\
        2 &\qfor \text{2D}\\
        2 + \beta &\qfor \text{3D}
    \end{cases},
    \end{split}
\end{align}
and
\begin{align}
    \begin{split}
    \laplacian_k u(r_{kj}) &= \grad_k\vdot u'(r_{kj})\frac{\vec
    r_{kj}}{r_{kj}} \\
    &= u'(r_{kj})\frac{2}{r_{kj}} + \frac{\vec r_{kj}}{r_{kj}}\vdot \grad_k
    u'(r_{kj})\\
    &= u''(r_{kj}) + \frac{2}{r_{kj}}u'(r_{kj}),
    \end{split}
\end{align}
where
\begin{align}
    \begin{split}
    u''(r_{ij}) &= \pdv[2]{}{r_{ij}} \ln(1-\frac{a}{r_{ij}})\\
    &= \frac{a(a-2r_{ij})}{r_{ij}^2(r_{ij}-a)^2}.
    \end{split}
\end{align}

Inserting all of this back into \eqref{eq:almost-done-EL} we get:
\begin{align}
    \begin{split}
    \frac{1}{\Psi_L}\laplacian_k{\Psi_L} &=  
    2\alpha\qty[2\alpha \norm{\hat{\vec r}_k}^2 - d(\beta)]\\
    &- 4\alpha\hat{\vec r}_k \vdot
    \qty[ \sum_{j\neq k} \frac{\vec r_{kj}}{r_{kj}}
    \frac{a}{r_{kj}(r_{kj}-a)}]\\
    &+  \sum_{i,j\neq k} \frac{\vec r_{ki}\vdot\vec r_{kj}}{r_{ki}r_{kj}}
    \frac{a}{r_{ki}(r_{ki}-a)}\frac{a}{r_{kj}(r_{kj}-a)}\\
    &+ \sum_{j\neq k} \qty(
    \frac{a(a-2r_{kj})}{r_{kj}^2(r_{kj}-a)^2} +
    \frac{2}{r_{kj}}\frac{a}{r_{kj}(r_{kj}-a)}
    ).
    \end{split} \label{eq:E_L-part-final}
\end{align*}
We may note that without interactions ($a=0$), this simplifies to only the first
term, as all the other terms are proportional to $a$.

The complete expression for the local energy is then:
\begin{align*}
    E_L &= \frac{1}{\Psi_T}H\Psi_T\\
    &= \sum_{i}V_{ext}(\vec r_i) + \sum_{i<j}V_{int}(\vec r_i,\vec r_j)
    - \frac{\hbar^2}{2m}\sum_k
    \frac{1}{\Psi_T}\laplacian_k\Psi_T\numberthis\label{eq:E_L-final}
\end{align*}
where we substitute in \eqref{eq:E_L-part-final} in the final sum.


\subsection{Finding an Analytical Expression for the Quantum Drift Force}
Anticipating its later use, we will also find an expression for the so called
quantum drift force, which we shall use when we consider importance sampling.
For now, we just give its definition:
\begin{align}
    \vec F_k = \frac{2\grad_k\Psi_T}{\Psi_T}
\end{align}
This is interpreted as the force acting on particle $k$ due to the trap and/or
presence of other particles. Luckily this can now be quickly evaluated due to
the results of the previous section,
\begin{align}
    \vec F_k = 2\qty[\sum_{j\neq k}\frac{\vec r_{kj}}{r_{kj}}
    \frac{a}{r_{kj}(r_{kj}-a)} - 2\alpha\hat{\vec r}_k].\label{eq:Q-force}
\end{align}


\printbibliography

\end{document}
